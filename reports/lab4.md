# Lab4 实验报告


李骋昊 2021010826

崇祯七甲辰四月十三日甲申

### Honor Code

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 **以下各位** 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

   -> 陈英豪，张庆林，关于unlink的过程

2. 此外，我也参考了 **以下资料** ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

   -> 无

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。



## 做的更改：

在inode中添加一个统计链接计数的项，并在link和unlink时维护，以此实现fstat

通过改写DirEntry,实现link和unlink

## 问答作业：


在我们的easy-fs中，root inode起着什么作用？如果root inode中的内容损坏了，会发生什么？

root inode在文件系统初始化时创建，逻辑上对应根目录。其中索引了所有的文件（本实验不支持子文件夹）的DirEntry。

如果root inode损坏，会无法正确通过文件名找到对应的inode, 无法正确读写文件。link, unlink，fstat等依赖root inode中的数据的文件相关的系统调用会在root inode损坏时成为未定义行为。



举出使用 pipe 的一个实际应用的例子。

`yes | sudo apt-get install <package name>`

这里`yes`不断输出`y`, 通过管道`sudo apt-get install`的标准输入，这样就不用在 apt-get install的时候手动输入`y`了。


如何使用 cat 和 wc 完成一个文件的行数统计？

`cat <文件名> | wc -l`


如果需要在多个进程间互相通信，则需要为每一对进程建立一个管道，非常繁琐，请设计一个更易用的多进程通信机制。

新建一个进程A，A和其他所有进程之间建立管道，负责转发。

假设进程B要给进程C发消息，进程B通过管道把 (C, 消息) 发给A， A看到后，把（B，消息）通过管道发给C。这样C就知道它从B收到了一条消息。


